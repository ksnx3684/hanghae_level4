# hanghae_level4
항해99 Node.js Level4

## ERD
https://drawsql.app/teams/ksnx3684s-team/diagrams/hanghae-level4

---

### 1. 좋아요 API는 어떻게 구현하였나요? 만약 1개로 구현하였다면, 분기 처리는 어떻게 처리하였나요?

- 사용자가 좋아요를 누를 때 마다 Posts 테이블의 likes 컬럼 값이 1씩 증가하고 좋아요 취소를 누르면 1씩 감소하도록 구성하였습니다.
- 동시에 Likes 테이블에도 사용자가 좋아요를 누르면 postId와 userId가 담긴 데이터를 삽입하고 사용자가 좋아요 취소 시 Likes 테이블에서 삭제시키는 방식으로 구현했습니다.
- 이런 방식을 통해 좋아요 API가 실행되면 가장 먼저 Likes 테이블을 조회하여 해당 사용자와 게시글의 id가 없으면 좋아요가 실행, 있으면 좋아요 취소가 실행되게 하여 각각의 기능이 처리되도록 하였습니다.
- 또한, Likes 테이블에 생성과 Posts 테이블의 수정 쿼리가 동시에 이루어지기 때문에 만일에 대비하여 트랜잭션 처리를 통한 데이터 유실과 오류를 방지하였습니다.

---


### 2. 게시글 조회에서 좋아요 갯수는 어떻게 가져왔나요? 구현한 방법이 가장 효율적인 방법이었을까요?

- Posts 테이블에 likes 컬럼을 추가하여 단순 조회만으로도 데이터를 불러올 수 있도록 구현하였습니다. 단, 자신이 좋아요 한 게시글에 한해서만 조회해야 하기 때문에 Posts 테이블과 Likes 테이블을 JOIN할 필요가 있었습니다. 따라서 sequelize의 include 구문을 이용하여 두 테이블을 JOIN하여 조건에 맞도록 설정하여 조회 API를 구현했습니다.